{"version":3,"sources":["../../src/controllers/phasorMap_ctrl.js"],"names":["MetricsPanelCtrl","L","_","moment","TileServers","PhasorMapCtrl","$scope","$injector","$rootScope","events","on","onInitEditMode","bind","onPanelTeardown","onRender","onPanelInitialized","onDataRecieved","onDataError","onRefresh","panel","mapBackgrounds","Object","keys","mapBackground","undefined","maxZoom","options","minZoom","zoomLevel","lockMap","maxLongitude","maxLatitude","minLatitude","minLongitude","circleRadius","useReferenceValue","referencePointTag","useAngleMean","angleMeanTimeWindow","showLegend","tileLayer","mapContainer","circleMarkers","data","addEditorTab","map","off","ctrl","height","row","render","console","log","createMap","plotPhasorData","msg","mapOptions","zoomControl","attributionControl","boxZoom","doubleClickZoom","dragging","zoomDelta","id","url","addTo","updateMapView","event","getZoom","bounds","getBounds","_southWest","lng","_northEast","lat","refresh","div","canvas","$","children","context","getContext","clearRect","width","center","x","y","chartRadius","drawBackground","strokeStyle","beginPath","arc","Math","PI","stroke","fillStyle","fill","drawGrid","lineWidth","i","drawVector","drawCircle","drawPhasors","vMax","iMax","each","phasorData","key","series","color","dataPoint","vector","xaxisHover","scale","setLineDash","r","t","cos","sin","moveTo","lineTo","drawAngleArrow","angle","radians","headlen","drawMagCircle","magnitude","drawLine","magvalue","anglevalue","minanglevalue","maxanglevalue","element","index","list","remove","parseInt","toString","divIcon","html","iconSize","circle","marker","latitude","longitude","icon","push","updatePhasorChart","_icon","setZoom","fitBounds","markerGroup","featureGroup","isValid","min","max","step","input","templateUrl"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuBSA,4B,kBAAAA,gB;;AACGC,a;;AACLC,a;;AACAC,kB;;AAEEC,uB,gBAAAA,W;;;;;;;;;;;;;;;;;;;;;qCAEIC,a;;;AACT;AACA,uCAAYC,MAAZ,EAAoBC,SAApB,EAA+BC,UAA/B,EAA2C;AAAA;;AAAA,8IACjCF,MADiC,EACzBC,SADyB;;AAGvC,0BAAKE,MAAL,CAAYC,EAAZ,CAAe,gBAAf,EAAiC,MAAKC,cAAL,CAAoBC,IAApB,OAAjC;AACA,0BAAKH,MAAL,CAAYC,EAAZ,CAAe,gBAAf,EAAiC,MAAKG,eAAL,CAAqBD,IAArB,OAAjC;AACA,0BAAKH,MAAL,CAAYC,EAAZ,CAAe,QAAf,EAAyB,MAAKI,QAAL,CAAcF,IAAd,OAAzB;AACA,0BAAKH,MAAL,CAAYC,EAAZ,CAAe,mBAAf,EAAoC,MAAKK,kBAAL,CAAwBH,IAAxB,OAApC;AACA,0BAAKH,MAAL,CAAYC,EAAZ,CAAe,eAAf,EAAgC,MAAKM,cAAL,CAAoBJ,IAApB,OAAhC;AACA;AACA,0BAAKH,MAAL,CAAYC,EAAZ,CAAe,YAAf,EAA6B,MAAKO,WAAL,CAAiBL,IAAjB,OAA7B;AACA,0BAAKH,MAAL,CAAYC,EAAZ,CAAe,SAAf,EAA0B,MAAKQ,SAAL,CAAeN,IAAf,OAA1B;;AAEA;AACA,0BAAKO,KAAL,CAAWC,cAAX,GAA4BC,OAAOC,IAAP,CAAYlB,WAAZ,CAA5B;AACA,0BAAKe,KAAL,CAAWI,aAAX,GAA6B,MAAKJ,KAAL,CAAWI,aAAX,IAA4BC,SAA5B,GAAwC,MAAKL,KAAL,CAAWI,aAAnD,GAAmE,MAAKJ,KAAL,CAAWC,cAAX,CAA0B,CAA1B,CAAhG;AACA,0BAAKD,KAAL,CAAWM,OAAX,GAA4BrB,YAAY,MAAKe,KAAL,CAAWI,aAAvB,EAAsCG,OAAtC,CAA8CD,OAA1E;AACA,0BAAKN,KAAL,CAAWQ,OAAX,GAA6BvB,YAAY,MAAKe,KAAL,CAAWI,aAAvB,EAAsCG,OAAtC,CAA8CC,OAA9C,IAAyDH,SAAzD,GAAqEpB,YAAY,MAAKe,KAAL,CAAWI,aAAvB,EAAsCG,OAAtC,CAA8CC,OAAnH,GAA6H,CAA1J;AACA,0BAAKR,KAAL,CAAWS,SAAX,GAA6B,MAAKT,KAAL,CAAWS,SAAX,IAA8BJ,SAA9B,GAA0C,MAAKL,KAAL,CAAWS,SAArD,GAAqExB,YAAY,MAAKe,KAAL,CAAWI,aAAvB,EAAsCG,OAAtC,CAA8CD,OAAhJ;AACA,0BAAKN,KAAL,CAAWU,OAAX,GAA6B,MAAKV,KAAL,CAAWU,OAAX,IAA8BL,SAA9B,GAA0C,MAAKL,KAAL,CAAWU,OAArD,GAAqE,IAAlG;AACA,0BAAKV,KAAL,CAAWW,YAAX,GAA6B,MAAKX,KAAL,CAAWW,YAAX,IAA8BN,SAA9B,GAA0C,MAAKL,KAAL,CAAWW,YAArD,GAAqE,CAAC,GAAnG;AACA,0BAAKX,KAAL,CAAWY,WAAX,GAA6B,MAAKZ,KAAL,CAAWY,WAAX,IAA8BP,SAA9B,GAA0C,MAAKL,KAAL,CAAWY,WAArD,GAAqE,EAAlG;AACA,0BAAKZ,KAAL,CAAWa,WAAX,GAA6B,MAAKb,KAAL,CAAWa,WAAX,IAA8BR,SAA9B,GAA0C,MAAKL,KAAL,CAAWa,WAArD,GAAqE,EAAlG;AACA,0BAAKb,KAAL,CAAWc,YAAX,GAA6B,MAAKd,KAAL,CAAWc,YAAX,IAA8BT,SAA9B,GAA0C,MAAKL,KAAL,CAAWc,YAArD,GAAqE,CAAC,EAAnG;AACA,0BAAKd,KAAL,CAAWe,YAAX,GAA6B,MAAKf,KAAL,CAAWe,YAAX,IAA8BV,SAA9B,GAA0C,MAAKL,KAAL,CAAWe,YAArD,GAAqE,EAAlG;AACA,0BAAKf,KAAL,CAAWgB,iBAAX,GAAgC,MAAKhB,KAAL,CAAWgB,iBAAX,IAAgCX,SAAhC,GAA4C,MAAKL,KAAL,CAAWgB,iBAAvD,GAA2E,KAA3G;AACA,0BAAKhB,KAAL,CAAWiB,iBAAX,GAAgC,MAAKjB,KAAL,CAAWiB,iBAAX,IAAgCZ,SAAhC,GAA4C,MAAKL,KAAL,CAAWiB,iBAAvD,GAA2E,EAA3G;AACA,0BAAKjB,KAAL,CAAWkB,YAAX,GAA2B,MAAKlB,KAAL,CAAWkB,YAAX,IAA2Bb,SAA3B,GAAuC,MAAKL,KAAL,CAAWkB,YAAlD,GAAiE,KAA5F;AACA,0BAAKlB,KAAL,CAAWmB,mBAAX,GAAkC,MAAKnB,KAAL,CAAWmB,mBAAX,IAAkCd,SAAlC,GAA8C,MAAKL,KAAL,CAAWmB,mBAAzD,GAA+E,GAAjH;AACA,0BAAKnB,KAAL,CAAWoB,UAAX,GAAyB,MAAKpB,KAAL,CAAWoB,UAAX,IAAyBf,SAAzB,GAAqC,MAAKL,KAAL,CAAWoB,UAAhD,GAA6D,KAAtF;;AAEA;AACA,0BAAKjC,MAAL,CAAYkC,SAAZ,GAAwB,IAAxB;AACA,0BAAKlC,MAAL,CAAYmC,YAAZ,GAA2B,IAA3B;AACA,0BAAKnC,MAAL,CAAYoC,aAAZ,GAA4B,EAA5B;AACA,0BAAKpC,MAAL,CAAYqC,IAAZ,GAAmB,EAAnB;AAlCuC;AAmC1C;AACD;;AAEA;;;;;qDACiB;AACb,6BAAKC,YAAL,CAAkB,SAAlB,EAA6B,4EAA7B,EAA2G,CAA3G;AACA,6BAAKA,YAAL,CAAkB,SAAlB,EAA6B,oFAA7B,EAAmH,CAAnH;AACA;AACH;;;sDAEiB;AACd,4BAAI,KAAKC,GAAT,EAAc;AACV,iCAAKA,GAAL,CAASC,GAAT,CAAa,SAAb;AACA,iCAAKD,GAAL,CAASC,GAAT,CAAa,SAAb;AACH;AACD;AACH;;;yDAEmB;AAChB;AACH;;;gDAEW;AACR,4BAAIC,OAAO,IAAX;;AAEA,4BAAIA,KAAKC,MAAL,GAAcD,KAAKE,GAAL,CAASD,MAA3B,EAAmCD,KAAKG,MAAL;;AAEnC;AACH;;;+CAEU;AACP,4BAAIH,OAAO,IAAX;AACAI,gCAAQC,GAAR,CAAY,SAAZ;AACH;;;+CAEU;AACP;AACH;;;mDAEcT,I,EAAM;AACjB,4BAAII,OAAO,IAAX;;AAEAA,6BAAKzC,MAAL,CAAYqC,IAAZ,GAAmBA,IAAnB;;AAEAI,6BAAKM,SAAL;;AAEAN,6BAAKO,cAAL,CAAoBX,IAApB;AACA;AACH;;;gDAEWY,G,EAAK;AACbJ,gCAAQC,GAAR,CAAY,YAAZ;AACH;;;gDAIW;AACR,4BAAIL,OAAO,IAAX;;AAEA,4BAAIA,KAAKzC,MAAL,CAAYmC,YAAZ,IAA4B,IAAhC,EAAsC;;AAElC,gCAAIe,aAAa;AACbC,6CAAa,KADA;AAEbC,oDAAoB,KAFP;AAGbC,yCAAS,KAHI;AAIbC,iDAAiB,KAJJ;AAKbC,0CAAWd,KAAK5B,KAAL,CAAWU,OAAX,IAAsB,IALpB;AAMbiC,2CAAYf,KAAK5B,KAAL,CAAWU,OAAX,IAAsB,IAAtB,GAA4B,CAA5B,GAA+B,CAN9B;AAObF,yCAAUoB,KAAK5B,KAAL,CAAWU,OAAX,IAAsB,IAAtB,GAA6BkB,KAAK5B,KAAL,CAAWQ,OAAxC,GAAkDoB,KAAK5B,KAAL,CAAWS,SAP1D;AAQbH,yCAAUsB,KAAK5B,KAAL,CAAWU,OAAX,IAAsB,IAAtB,GAA6BkB,KAAK5B,KAAL,CAAWM,OAAxC,GAAkDsB,KAAK5B,KAAL,CAAWS;AAR1D,6BAAjB;;AAWAmB,iCAAKzC,MAAL,CAAYmC,YAAZ,GAA2BxC,EAAE4C,GAAF,CAAM,WAAWE,KAAK5B,KAAL,CAAW4C,EAA5B,EAAgCP,UAAhC,CAA3B;AACAT,iCAAKzC,MAAL,CAAYkC,SAAZ,GAAwBvC,EAAEuC,SAAF,CAAYpC,YAAY2C,KAAK5B,KAAL,CAAWI,aAAvB,EAAsCyC,GAAlD,EAAuD5D,YAAY2C,KAAK5B,KAAL,CAAWI,aAAvB,EAAsCG,OAA7F,CAAxB;AACAqB,iCAAKzC,MAAL,CAAYkC,SAAZ,CAAsByB,KAAtB,CAA4BlB,KAAKzC,MAAL,CAAYmC,YAAxC;AACAM,iCAAKmB,aAAL;;AAEA;AACAnB,iCAAKzC,MAAL,CAAYmC,YAAZ,CAAyBK,GAAzB,CAA6B,SAA7B;AACAC,iCAAKzC,MAAL,CAAYmC,YAAZ,CAAyB/B,EAAzB,CAA4B,SAA5B,EAAuC,UAAUyD,KAAV,EAAiB;AACpDpB,qCAAK5B,KAAL,CAAWS,SAAX,GAAuBmB,KAAKzC,MAAL,CAAYmC,YAAZ,CAAyB2B,OAAzB,EAAvB;;AAEA,oCAAIC,SAAStB,KAAKzC,MAAL,CAAYmC,YAAZ,CAAyB6B,SAAzB,EAAb;AACAvB,qCAAK5B,KAAL,CAAWW,YAAX,GAA0BuC,OAAOE,UAAP,CAAkBC,GAA5C;AACAzB,qCAAK5B,KAAL,CAAWY,WAAX,GAAyBsC,OAAOI,UAAP,CAAkBC,GAA3C;AACA3B,qCAAK5B,KAAL,CAAWa,WAAX,GAAyBqC,OAAOE,UAAP,CAAkBG,GAA3C;AACA3B,qCAAK5B,KAAL,CAAWc,YAAX,GAA0BoC,OAAOI,UAAP,CAAkBD,GAA5C;;AAEAzB,qCAAK4B,OAAL;AACH,6BAVD;AAWA5B,iCAAKzC,MAAL,CAAYmC,YAAZ,CAAyBK,GAAzB,CAA6B,SAA7B;AACAC,iCAAKzC,MAAL,CAAYmC,YAAZ,CAAyB/B,EAAzB,CAA4B,SAA5B,EAAuC,UAAUyD,KAAV,EAAiB;AACpDpB,qCAAK5B,KAAL,CAAWS,SAAX,GAAuBmB,KAAKzC,MAAL,CAAYmC,YAAZ,CAAyB2B,OAAzB,EAAvB;;AAEA,oCAAIC,SAAStB,KAAKzC,MAAL,CAAYmC,YAAZ,CAAyB6B,SAAzB,EAAb;AACAvB,qCAAK5B,KAAL,CAAWW,YAAX,GAA0BuC,OAAOE,UAAP,CAAkBC,GAA5C;AACAzB,qCAAK5B,KAAL,CAAWY,WAAX,GAAyBsC,OAAOI,UAAP,CAAkBC,GAA3C;AACA3B,qCAAK5B,KAAL,CAAWa,WAAX,GAAyBqC,OAAOE,UAAP,CAAkBG,GAA3C;AACA3B,qCAAK5B,KAAL,CAAWc,YAAX,GAA0BoC,OAAOI,UAAP,CAAkBD,GAA5C;;AAEAzB,qCAAK4B,OAAL;AACH,6BAVD;AAYH;AACJ;;;sDAEiBC,G,EAAKjC,I,EAAM;AACzB,4BAAII,OAAO,IAAX;;AAEA,4BAAI8B,SAASC,EAAEF,GAAF,EAAOG,QAAP,EAAb;AACA,4BAAIC,UAAUH,OAAO,CAAP,EAAUI,UAAV,CAAqB,IAArB,CAAd;AACAD,gCAAQE,SAAR,CAAkB,CAAlB,EAAqB,CAArB,EAAwBL,OAAOM,KAA/B,EAAsCN,OAAO7B,MAA7C;;AAEA,4BAAIoC,SAAS,EAAEC,GAAGR,OAAOM,KAAP,KAAiB,CAAtB,EAAyBG,GAAGT,OAAO7B,MAAP,KAAkB,CAA9C,EAAb;AACA,4BAAIuC,cAAcxC,KAAK5B,KAAL,CAAWe,YAA7B;;AAEA,iCAASsD,cAAT,GACA;AACIR,oCAAQS,WAAR,GAAsB,SAAtB;AACAT,oCAAQU,SAAR;AACAV,oCAAQW,GAAR,CAAYP,OAAOC,CAAnB,EAAsBD,OAAOE,CAA7B,EAAgCC,WAAhC,EAA6C,CAA7C,EAAgD,IAAIK,KAAKC,EAAzD;AACAb,oCAAQc,MAAR;AACAd,oCAAQe,SAAR,GAAoB,SAApB;AACAf,oCAAQgB,IAAR;AAEH;;AAED,iCAASC,QAAT,GAAoB;AAChBjB,oCAAQkB,SAAR,GAAoB,CAApB;AACAlB,oCAAQS,WAAR,GAAsB,MAAtB;AACA,iCAAK,IAAIU,IAAI,CAAb,EAAgBA,IAAI,EAApB,EAAwBA,GAAxB;AACIC,2CAAWb,WAAX,EAAwBY,IAAIP,KAAKC,EAAT,GAAc,CAAtC;AADJ,6BAEA,KAAK,IAAIM,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB;AACIE,2CAAW,IAAId,WAAJ,GAAkBY,CAAlB,GAAsB,CAAjC;AADJ;AAEH;;AAED,iCAASG,WAAT,GAAuB;AACnB,gCAAIC,OAAO,CAAX;AACA,gCAAIC,OAAO,CAAX;;AAEAxB,oCAAQkB,SAAR,GAAoB,CAApB;;AAEApB,8BAAE2B,IAAF,CAAOC,UAAP,EAAmB,UAAUC,GAAV,EAAeC,MAAf,EAAuB;AACtC,oCAAIA,UAAUpF,SAAd,EACI;;AAEJ,oCAAIoF,OAAOC,KAAP,IAAgBrF,SAApB,EACI;;AAEJsD,kCAAE2B,IAAF,CAAOG,OAAOjE,IAAd,EAAoB,UAAUzC,CAAV,EAAa4G,SAAb,EAAwB;AACxCF,2CAAOG,MAAP,GAAgBD,SAAhB;;AAEA,wCAAIA,UAAU,CAAV,KAAgBE,UAApB,EACI,OAAO,KAAP;AACP,iCALD;;AAOA,oCAAIL,MAAM,CAAN,IAAWC,OAAOG,MAAP,CAAc,CAAd,IAAmBR,IAAlC,EACIA,OAAOK,OAAOG,MAAP,CAAc,CAAd,CAAP;AACJ,oCAAIJ,OAAO,CAAP,IAAYC,OAAOG,MAAP,CAAc,CAAd,IAAmBP,IAAnC,EACIA,OAAOI,OAAOG,MAAP,CAAc,CAAd,CAAP;AACP,6BAlBD;;AAoBAjC,8BAAE2B,IAAF,CAAOC,UAAP,EAAmB,UAAUC,GAAV,EAAeC,MAAf,EAAuB;AACtC,oCAAIK,KAAJ;;AAEA,oCAAIL,UAAUpF,SAAd,EACI;;AAEJ,oCAAIoF,OAAOG,MAAP,IAAiBvF,SAArB,EACI;;AAEJ,oCAAImF,MAAM,CAAV,EAAa;AACTM,4CAAQ,MAAM1B,WAAN,GAAoBgB,IAA5B;AACH,iCAFD,MAGK;AACDU,4CAAQ,MAAM1B,WAAN,GAAoBiB,IAA5B;AACAxB,4CAAQkC,WAAR,CAAoB,CAAC,EAAD,EAAK,CAAL,CAApB;AACH;;AAEDlC,wCAAQS,WAAR,GAAsBmB,OAAOC,KAA7B;AACAT,2CAAWQ,OAAOG,MAAP,CAAc,CAAd,IAAmBE,KAA9B,EAAqCL,OAAOG,MAAP,CAAc,CAAd,CAArC;AACA/B,wCAAQkC,WAAR,CAAoB,EAApB;AACH,6BApBD;AAqBH;;AAED,iCAASd,UAAT,CAAoBe,CAApB,EAAuBC,CAAvB,EAA0B;AACtB,gCAAI/B,IAAI8B,IAAIvB,KAAKyB,GAAL,CAASD,CAAT,CAAZ;AACA,gCAAI9B,IAAI6B,IAAIvB,KAAK0B,GAAL,CAASF,CAAT,CAAZ;;AAEApC,oCAAQU,SAAR;AACAV,oCAAQuC,MAAR,CAAenC,OAAOC,CAAtB,EAAyBD,OAAOE,CAAhC;AACAN,oCAAQwC,MAAR,CAAepC,OAAOC,CAAP,GAAWA,CAA1B,EAA6BD,OAAOE,CAAP,GAAWA,CAAxC;AACAN,oCAAQc,MAAR;AACH;;AAED,iCAASO,UAAT,CAAoBc,CAApB,EAAuB;AACnBnC,oCAAQU,SAAR;AACAV,oCAAQW,GAAR,CAAYP,OAAOC,CAAnB,EAAsBD,OAAOE,CAA7B,EAAgC6B,CAAhC,EAAmC,CAAnC,EAAsC,IAAIvB,KAAKC,EAA/C;AACAb,oCAAQc,MAAR;AACH;;AAED,iCAAS2B,cAAT,CAAwBC,KAAxB,EAA+B;;AAE3BA,oCAAQA,QAAQ,EAAhB;AACA,gCAAIC,UAAUD,SAAS9B,KAAKC,EAAL,GAAU,GAAnB,CAAd;;AAEA,gCAAI+B,UAAU,CAAd,CAL2B,CAKR;AACnB,gCAAIvC,IAAIE,cAAcK,KAAKyB,GAAL,CAASM,OAAT,CAAd,GAAkCvC,OAAOC,CAAjD;AACA,gCAAIC,IAAIC,cAAcK,KAAK0B,GAAL,CAASK,OAAT,CAAd,GAAkCvC,OAAOE,CAAjD;;AAEAN,oCAAQS,WAAR,GAAsB,SAAtB;AACAT,oCAAQU,SAAR;AACAV,oCAAQuC,MAAR,CAAenC,OAAOC,CAAtB,EAAyBD,OAAOE,CAAhC;AACAN,oCAAQwC,MAAR,CAAenC,CAAf,EAAkBC,CAAlB;AACAN,oCAAQwC,MAAR,CAAenC,IAAIuC,UAAUhC,KAAKyB,GAAL,CAASM,UAAU/B,KAAKC,EAAL,GAAU,CAA7B,CAA7B,EAA8DP,IAAIsC,UAAUhC,KAAK0B,GAAL,CAASK,UAAU/B,KAAKC,EAAL,GAAQ,CAA3B,CAA5E;AACAb,oCAAQuC,MAAR,CAAelC,CAAf,EAAkBC,CAAlB;AACAN,oCAAQwC,MAAR,CAAenC,IAAIuC,UAAUhC,KAAKyB,GAAL,CAASM,UAAU/B,KAAKC,EAAL,GAAU,CAA7B,CAA7B,EAA8DP,IAAIsC,UAAUhC,KAAK0B,GAAL,CAASK,UAAU/B,KAAKC,EAAL,GAAU,CAA7B,CAA5E;AACAb,oCAAQc,MAAR;AACH;;AAED,iCAAS+B,aAAT,CAAuBC,SAAvB,EAAkC;AAC9B9C,oCAAQS,WAAR,GAAsB,SAAtB;AACAT,oCAAQU,SAAR;AACAV,oCAAQW,GAAR,CAAYP,OAAOC,CAAnB,EAAsBD,OAAOE,CAA7B,EAAgCC,eAAauC,YAAU,CAAvB,CAAhC,EAA2D,CAA3D,EAA8D,IAAIlC,KAAKC,EAAvE;AACAb,oCAAQc,MAAR;AACAd,oCAAQe,SAAR,GAAoB,SAApB;AACAf,oCAAQgB,IAAR;AAEH;;AAED,iCAAS+B,QAAT,CAAkBL,KAAlB,EAAyBb,KAAzB,EAAgC;AAC5Ba,oCAAQA,QAAQ,EAAhB;AACA,gCAAIC,UAAUD,SAAS9B,KAAKC,EAAL,GAAU,GAAnB,CAAd;;AAEA,gCAAIR,IAAIE,cAAcK,KAAKyB,GAAL,CAASM,OAAT,CAAd,GAAkCvC,OAAOC,CAAjD;AACA,gCAAIC,IAAIC,cAAcK,KAAK0B,GAAL,CAASK,OAAT,CAAd,GAAkCvC,OAAOE,CAAjD;;AAEAN,oCAAQS,WAAR,GAAsBoB,KAAtB;AACA7B,oCAAQU,SAAR;AACAV,oCAAQuC,MAAR,CAAenC,OAAOC,CAAtB,EAAyBD,OAAOE,CAAhC;AACAN,oCAAQwC,MAAR,CAAenC,CAAf,EAAkBC,CAAlB;AACAN,oCAAQc,MAAR;AACH;;AAGDN;AACAS;AACA4B,sCAAclF,KAAKqF,QAAnB;;AAEAP,uCAAe9E,KAAKsF,UAApB;AACAF,iCAASpF,KAAKuF,aAAd,EAA6B,SAA7B;AACAH,iCAASpF,KAAKwF,aAAd,EAA6B,SAA7B;AACA;AACA;AACH;;;mDAKcxF,I,EAAM;AACjB,4BAAII,OAAO,IAAX;;AAEA7C,0BAAEuG,IAAF,CAAO1D,KAAKzC,MAAL,CAAYoC,aAAnB,EAAkC,UAAU0F,OAAV,EAAmBC,KAAnB,EAA0BC,IAA1B,EAAgC;AAC9DF,oCAAQG,MAAR;AACH,yBAFD;;AAIArI,0BAAEuG,IAAF,CAAO9D,IAAP,EAAa,UAAUyF,OAAV,EAAmBC,KAAnB,EAA0BC,IAA1B,EAAgC;AACzC,gCAAInB,IAAIqB,SAASzF,KAAK5B,KAAL,CAAWe,YAAX,CAAwBuG,QAAxB,EAAT,IAA+C,GAAvD;AACA,gCAAIC,UAAUzI,EAAEyI,OAAF,CAAU;AACpBC,sCAAM,oBAAoB,IAAIxB,CAAxB,GAA4B,YAA5B,GAA2C,IAAIA,CAA/C,GAAmD,mCAAnD,IAA0FA,IAAI,CAA9F,IAAmG,WAAnG,IAAkHA,IAAI,CAAtH,IAA2H,eAD7G;AAEpByB,0CAAU,CAAC,EAAD,EAAK,EAAL;AAFU,6BAAV,CAAd;AAIA,gCAAIC,SAAS5I,EAAE6I,MAAF,CAAS,CAACV,QAAQW,QAAT,EAAmBX,QAAQY,SAA3B,CAAT,EAAgD,EAAEC,MAAMP,OAAR,EAAhD,CAAb;AACA3F,iCAAKzC,MAAL,CAAYoC,aAAZ,CAA0BwG,IAA1B,CAA+BL,MAA/B;AACAA,mCAAO5E,KAAP,CAAalB,KAAKzC,MAAL,CAAYmC,YAAzB;AACAM,iCAAKoG,iBAAL,CAAuBN,OAAOO,KAA9B,EAAqChB,OAArC;AACH,yBAVD;AAYH;;;0DAKqB;AAClB,4BAAIrF,OAAO,IAAX;;AAEAA,6BAAKzC,MAAL,CAAYkC,SAAZ,CAAsB+F,MAAtB;AACAxF,6BAAKzC,MAAL,CAAYkC,SAAZ,GAAwBvC,EAAEuC,SAAF,CAAYpC,YAAY,KAAKe,KAAL,CAAWI,aAAvB,EAAsCyC,GAAlD,EAAuD5D,YAAY,KAAKe,KAAL,CAAWI,aAAvB,EAAsCG,OAA7F,CAAxB;AACAqB,6BAAKzC,MAAL,CAAYkC,SAAZ,CAAsByB,KAAtB,CAA4B,KAAK3D,MAAL,CAAYmC,YAAxC;AACH;;;iDAEY;AACT,4BAAIM,OAAO,IAAX;;AAEAA,6BAAKzC,MAAL,CAAYmC,YAAZ,CAAyBf,OAAzB,CAAiCC,OAAjC,GAA4CoB,KAAK5B,KAAL,CAAWU,OAAX,IAAsB,IAAtB,GAA6BkB,KAAK5B,KAAL,CAAWQ,OAAxC,GAAkDoB,KAAK5B,KAAL,CAAWS,SAAzG;AACAmB,6BAAKzC,MAAL,CAAYmC,YAAZ,CAAyBf,OAAzB,CAAiCD,OAAjC,GAA4CsB,KAAK5B,KAAL,CAAWU,OAAX,IAAsB,IAAtB,GAA6BkB,KAAK5B,KAAL,CAAWM,OAAxC,GAAkDsB,KAAK5B,KAAL,CAAWS,SAAzG;;AAEAmB,6BAAKzC,MAAL,CAAYmC,YAAZ,CAAyB4G,OAAzB,CAAiCtG,KAAK5B,KAAL,CAAWS,SAA5C;AACH;;;oDAEe;AACZ,4BAAImB,OAAO,IAAX;;AAEAA,6BAAKzC,MAAL,CAAYmC,YAAZ,CAAyB6G,SAAzB,CAAmC,CAC/B,CAACvG,KAAK5B,KAAL,CAAWY,WAAZ,EAAyBgB,KAAK5B,KAAL,CAAWW,YAApC,CAD+B,EAE/B,CAACiB,KAAK5B,KAAL,CAAWa,WAAZ,EAAyBe,KAAK5B,KAAL,CAAWc,YAApC,CAF+B,CAAnC;AAIH;;;8CAES;AACN,4BAAIc,OAAO,IAAX;;AAEAA,6BAAKzC,MAAL,CAAYmC,YAAZ,CAAyB8F,MAAzB;AACAxF,6BAAKzC,MAAL,CAAYmC,YAAZ,GAA2B,IAA3B;AACAM,6BAAKM,SAAL;AACH;;;qDAEgB;AACb,4BAAIN,OAAO,IAAX;;AAEA,4BAAIwG,cAAc,IAAItJ,EAAEuJ,YAAN,CAAmBzG,KAAKzC,MAAL,CAAYoC,aAA/B,CAAlB;AACA,4BAAI6G,YAAYjF,SAAZ,GAAwBmF,OAAxB,EAAJ,EACI1G,KAAKzC,MAAL,CAAYmC,YAAZ,CAAyB6G,SAAzB,CAAmCC,YAAYjF,SAAZ,EAAnC;;AAEJ,4BAAID,SAAStB,KAAKzC,MAAL,CAAYmC,YAAZ,CAAyB6B,SAAzB,EAAb;AACAvB,6BAAK5B,KAAL,CAAWW,YAAX,GAA0BuC,OAAOE,UAAP,CAAkBC,GAA5C;AACAzB,6BAAK5B,KAAL,CAAWY,WAAX,GAAyBsC,OAAOI,UAAP,CAAkBC,GAA3C;AACA3B,6BAAK5B,KAAL,CAAWa,WAAX,GAAyBqC,OAAOE,UAAP,CAAkBG,GAA3C;AACA3B,6BAAK5B,KAAL,CAAWc,YAAX,GAA0BoC,OAAOI,UAAP,CAAkBD,GAA5C;AACH;;;6CAIQkF,G,EAAKC,G,EAAKC,I,EAAM;AACrBA,+BAAOA,QAAQ,CAAf;AACA,4BAAIC,QAAQ,EAAZ;AACA,6BAAK,IAAI1D,IAAIuD,GAAb,EAAkBvD,KAAKwD,GAAvB,EAA4BxD,KAAKyD,IAAjC,EAAuC;AACnCC,kCAAMX,IAAN,CAAW/C,CAAX;AACH;AACD,+BAAO0D,KAAP;AACH;;;6CAGQnC,K,EAAO;AACZ,4BAAIA,QAAQ,CAAC,GAAT,IAAgBA,SAAS,GAA7B,EAAkC,OAAOA,KAAP,CAAlC,KACK,IAAIA,SAAS,CAAC,GAAd,EAAmB,OAAO,MAAMA,KAAb,CAAnB,KACA,IAAIA,QAAQ,GAAZ,EAAiB,OAAOA,QAAQ,GAAf;AACzB;;;;cAhY8B1H,gB;;;;AAmYnCK,0BAAcyJ,WAAd,GAA4B,sBAA5B","file":"phasorMap_ctrl.js","sourcesContent":["﻿//******************************************************************************************************\r\n//  phasorMap_ctrl.js - Gbtc\r\n//\r\n//  Copyright © 2017, Grid Protection Alliance.  All Rights Reserved.\r\n//\r\n//  Licensed to the Grid Protection Alliance (GPA) under one or more contributor license agreements. See\r\n//  the NOTICE file distributed with this work for additional information regarding copyright ownership.\r\n//  The GPA licenses this file to you under the MIT License (MIT), the \"License\"; you may not use this\r\n//  file except in compliance with the License. You may obtain a copy of the License at:\r\n//\r\n//      http://opensource.org/licenses/MIT\r\n//\r\n//  Unless agreed to in writing, the subject software distributed under the License is distributed on an\r\n//  \"AS-IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. Refer to the\r\n//  License for the specific language governing permissions and limitations.\r\n//\r\n//  Code Modification History:\r\n//  ----------------------------------------------------------------------------------------------------\r\n//  10/23/2017 - Billy Ernest\r\n//       Generated original version of source code.\r\n//\r\n//******************************************************************************************************\r\n\r\nimport { MetricsPanelCtrl } from 'app/plugins/sdk'\r\nimport * as L from '../lib/leaflet';\r\nimport _ from 'lodash';\nimport moment from 'moment';\nimport '../css/leaflet.css!';\nimport { TileServers } from './../js/constants';\n\nexport class PhasorMapCtrl extends MetricsPanelCtrl{\r\n    // #region Constructor\r\n    constructor($scope, $injector, $rootScope) {\r\n        super($scope, $injector);\r\n\r\n        this.events.on('init-edit-mode', this.onInitEditMode.bind(this));\r\n        this.events.on('panel-teardown', this.onPanelTeardown.bind(this));\r\n        this.events.on('render', this.onRender.bind(this));\r\n        this.events.on('panel-initialized', this.onPanelInitialized.bind(this));\r\n        this.events.on('data-received', this.onDataRecieved.bind(this));\r\n        //this.events.on('data-snapshot-load', console.log('data-snapshot-load'));\r\n        this.events.on('data-error', this.onDataError.bind(this));\r\n        this.events.on('refresh', this.onRefresh.bind(this));\n        \r\n        // Variables for options\r\n        this.panel.mapBackgrounds = Object.keys(TileServers);\r\n        this.panel.mapBackground  = (this.panel.mapBackground != undefined ? this.panel.mapBackground : this.panel.mapBackgrounds[0]);\r\n        this.panel.maxZoom        = TileServers[this.panel.mapBackground].options.maxZoom;\r\n        this.panel.minZoom =        (TileServers[this.panel.mapBackground].options.minZoom != undefined ? TileServers[this.panel.mapBackground].options.minZoom : 2)\r\n        this.panel.zoomLevel =      (this.panel.zoomLevel       != undefined ? this.panel.zoomLevel     : TileServers[this.panel.mapBackground].options.maxZoom);\r\n        this.panel.lockMap =        (this.panel.lockMap         != undefined ? this.panel.lockMap       : 'No'  );\r\n        this.panel.maxLongitude =   (this.panel.maxLongitude    != undefined ? this.panel.maxLongitude  : -125  );\r\n        this.panel.maxLatitude =    (this.panel.maxLatitude     != undefined ? this.panel.maxLatitude   : 24    );\r\n        this.panel.minLatitude =    (this.panel.minLatitude     != undefined ? this.panel.minLatitude   : 50    );\r\n        this.panel.minLongitude =   (this.panel.minLongitude    != undefined ? this.panel.minLongitude  : -66   );\r\n        this.panel.circleRadius =   (this.panel.circleRadius    != undefined ? this.panel.circleRadius  : 50    );  \r\n        this.panel.useReferenceValue = (this.panel.useReferenceValue != undefined ? this.panel.useReferenceValue : false);\r\n        this.panel.referencePointTag = (this.panel.referencePointTag != undefined ? this.panel.referencePointTag : '');  \r\n        this.panel.useAngleMean = (this.panel.useAngleMean != undefined ? this.panel.useAngleMean : false);\r\n        this.panel.angleMeanTimeWindow = (this.panel.angleMeanTimeWindow != undefined ? this.panel.angleMeanTimeWindow : '5');\r\n        this.panel.showLegend = (this.panel.showLegend != undefined ? this.panel.showLegend : false);\r\n\r\n        // Scope Variables\r\n        this.$scope.tileLayer = null;\r\n        this.$scope.mapContainer = null;\r\n        this.$scope.circleMarkers = [];\r\n        this.$scope.data = [];\r\n    }\r\n    // #endregion\r\n\r\n    // #region Events from Graphana Handlers\r\n    onInitEditMode() {\r\n        this.addEditorTab('Options', 'public/plugins/gridprotectionalliance-phasormap-panel/partials/editor.html', 2);\n        this.addEditorTab('Circles', 'public/plugins/gridprotectionalliance-phasormap-panel/partials/circle_options.html', 3);\n        //console.log('init-edit-mode');\r\n    }\r\n\r\n    onPanelTeardown() {\r\n        if (this.map) {\r\n            this.map.off('zoomend');\r\n            this.map.off('moveend');\r\n        }\r\n        //console.log('panel-teardown');\r\n    }\r\n\r\n    onPanelInitialized(){\r\n        //console.log('panel-initialized');\r\n    }\r\n\r\n    onRefresh() {\n        var ctrl = this;\n\n        if (ctrl.height > ctrl.row.height) ctrl.render();\n\n        //console.log('refresh');\r\n    }\n\n    onResize() {\n        var ctrl = this;\n        console.log('refresh');\r\n    }\n\n    onRender() {\n        //console.log('render');\r\n    }\n\n    onDataRecieved(data) {\n        var ctrl = this;\n\n        ctrl.$scope.data = data;\n\n        ctrl.createMap();\n\n        ctrl.plotPhasorData(data);\n        //console.log('data-recieved');\r\n    }\n\n    onDataError(msg) {\n        console.log('data-error');\r\n    }\n    // #endregion\n\r\n    // #region Map and Marker Creation\r\n    createMap() {\r\n        var ctrl = this;\r\n\r\n        if (ctrl.$scope.mapContainer == null) {\r\n\r\n            var mapOptions = {\r\n                zoomControl: false,\r\n                attributionControl: false,\r\n                boxZoom: false,\r\n                doubleClickZoom: false,\r\n                dragging: (ctrl.panel.lockMap == 'No'),\r\n                zoomDelta: (ctrl.panel.lockMap == 'No'? 1: 0),\r\n                minZoom: (ctrl.panel.lockMap == 'No' ? ctrl.panel.minZoom : ctrl.panel.zoomLevel),\r\n                maxZoom: (ctrl.panel.lockMap == 'No' ? ctrl.panel.maxZoom : ctrl.panel.zoomLevel)\r\n            };\r\n\r\n            ctrl.$scope.mapContainer = L.map('mapid_' + ctrl.panel.id, mapOptions);\r\n            ctrl.$scope.tileLayer = L.tileLayer(TileServers[ctrl.panel.mapBackground].url, TileServers[ctrl.panel.mapBackground].options);\r\n            ctrl.$scope.tileLayer.addTo(ctrl.$scope.mapContainer);\r\n            ctrl.updateMapView();\r\n\r\n            // setup map listeners\r\n            ctrl.$scope.mapContainer.off('zoomend');\r\n            ctrl.$scope.mapContainer.on('zoomend', function (event) {\r\n                ctrl.panel.zoomLevel = ctrl.$scope.mapContainer.getZoom();\r\n\r\n                var bounds = ctrl.$scope.mapContainer.getBounds();\r\n                ctrl.panel.maxLongitude = bounds._southWest.lng;\r\n                ctrl.panel.maxLatitude = bounds._northEast.lat;\r\n                ctrl.panel.minLatitude = bounds._southWest.lat;\r\n                ctrl.panel.minLongitude = bounds._northEast.lng;\r\n\r\n                ctrl.refresh();\r\n            });\r\n            ctrl.$scope.mapContainer.off('moveend');\r\n            ctrl.$scope.mapContainer.on('moveend', function (event) {\r\n                ctrl.panel.zoomLevel = ctrl.$scope.mapContainer.getZoom();\r\n\r\n                var bounds = ctrl.$scope.mapContainer.getBounds();\r\n                ctrl.panel.maxLongitude = bounds._southWest.lng;\r\n                ctrl.panel.maxLatitude = bounds._northEast.lat;\r\n                ctrl.panel.minLatitude = bounds._southWest.lat;\r\n                ctrl.panel.minLongitude = bounds._northEast.lng;\r\n\r\n                ctrl.refresh();\r\n            });\r\n\r\n        }\r\n    }\r\n\r\n    updatePhasorChart(div, data) {\r\n        var ctrl = this;\r\n\r\n        var canvas = $(div).children();\r\n        var context = canvas[0].getContext(\"2d\");\r\n        context.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n        var center = { x: canvas.width() / 2, y: canvas.height() / 2 };\r\n        var chartRadius = ctrl.panel.circleRadius;\r\n\r\n        function drawBackground()\r\n        {\r\n            context.strokeStyle = \"#000000\";\r\n            context.beginPath();\r\n            context.arc(center.x, center.y, chartRadius, 0, 2 * Math.PI);\r\n            context.stroke();\r\n            context.fillStyle = \"#FFFFFF\";\r\n            context.fill();\r\n\r\n        }\r\n\r\n        function drawGrid() {\r\n            context.lineWidth = 1;\r\n            context.strokeStyle = \"#DDD\";\r\n            for (var i = 0; i < 18; i++)\r\n                drawVector(chartRadius, i * Math.PI / 9);\r\n            for (var i = 1; i < 8; i++)\r\n                drawCircle(1 * chartRadius * i / 8);\r\n        }\r\n\r\n        function drawPhasors() {\r\n            var vMax = 0;\r\n            var iMax = 0;\r\n\r\n            context.lineWidth = 3;\r\n\r\n            $.each(phasorData, function (key, series) {\r\n                if (series == undefined)\r\n                    return;\r\n\r\n                if (series.color == undefined)\r\n                    return;\r\n\r\n                $.each(series.data, function (_, dataPoint) {\r\n                    series.vector = dataPoint;\r\n\r\n                    if (dataPoint[0] >= xaxisHover)\r\n                        return false;\r\n                });\r\n\r\n                if (key < 3 && series.vector[1] > vMax)\r\n                    vMax = series.vector[1];\r\n                if (key >= 3 && series.vector[1] > iMax)\r\n                    iMax = series.vector[1];\r\n            });\r\n\r\n            $.each(phasorData, function (key, series) {\r\n                var scale;\r\n\r\n                if (series == undefined)\r\n                    return;\r\n\r\n                if (series.vector == undefined)\r\n                    return;\r\n\r\n                if (key < 3) {\r\n                    scale = 0.9 * chartRadius / vMax;\r\n                }\r\n                else {\r\n                    scale = 0.9 * chartRadius / iMax;\r\n                    context.setLineDash([10, 5]);\r\n                }\r\n\r\n                context.strokeStyle = series.color;\r\n                drawVector(series.vector[1] * scale, series.vector[2]);\r\n                context.setLineDash([]);\r\n            });\r\n        }\r\n\r\n        function drawVector(r, t) {\r\n            var x = r * Math.cos(t);\r\n            var y = r * Math.sin(t);\r\n\r\n            context.beginPath();\r\n            context.moveTo(center.x, center.y);\r\n            context.lineTo(center.x + x, center.y - y);\r\n            context.stroke();\r\n        }\r\n\r\n        function drawCircle(r) {\r\n            context.beginPath();\r\n            context.arc(center.x, center.y, r, 0, 2 * Math.PI);\r\n            context.stroke();\r\n        }\r\n\r\n        function drawAngleArrow(angle) {\r\n\r\n            angle = angle - 90;\r\n            var radians = angle * (Math.PI / 180);\r\n\r\n            var headlen = 5;   // length of head in pixels\r\n            var x = chartRadius * Math.cos(radians) + center.x;\r\n            var y = chartRadius * Math.sin(radians) + center.y;\r\n\r\n            context.strokeStyle = \"#000000\";\r\n            context.beginPath();\r\n            context.moveTo(center.x, center.y);\r\n            context.lineTo(x, y);\r\n            context.lineTo(x - headlen * Math.cos(radians - Math.PI / 6), y - headlen * Math.sin(radians - Math.PI/6));\r\n            context.moveTo(x, y);\r\n            context.lineTo(x - headlen * Math.cos(radians + Math.PI / 6), y - headlen * Math.sin(radians + Math.PI / 6));\r\n            context.stroke();\r\n        }\r\n\r\n        function drawMagCircle(magnitude) {\r\n            context.strokeStyle = \"#FFFF00\";\r\n            context.beginPath();\r\n            context.arc(center.x, center.y, chartRadius*(magnitude/2), 0, 2 * Math.PI);\r\n            context.stroke();\r\n            context.fillStyle = \"#FFFF00\";\r\n            context.fill();\r\n\r\n        }\r\n\r\n        function drawLine(angle, color) {\r\n            angle = angle - 90;\r\n            var radians = angle * (Math.PI / 180);\r\n\r\n            var x = chartRadius * Math.cos(radians) + center.x;\r\n            var y = chartRadius * Math.sin(radians) + center.y;\r\n\r\n            context.strokeStyle = color;\r\n            context.beginPath();\r\n            context.moveTo(center.x, center.y);\r\n            context.lineTo(x, y);\r\n            context.stroke();\r\n        }\r\n\r\n\r\n        drawBackground();\r\n        drawGrid();\r\n        drawMagCircle(data.magvalue);\r\n\r\n        drawAngleArrow(data.anglevalue);\r\n        drawLine(data.minanglevalue, \"#FF0000\")\r\n        drawLine(data.maxanglevalue, \"#FF0000\")\r\n        //if (phasor.angleMean)\r\n        //    drawAverageLine(phasor.angleMean);\r\n    }\r\n\r\n    // #endregion\r\n\r\n    // #region Data\r\n    plotPhasorData(data) {\r\n        var ctrl = this;\r\n\r\n        _.each(ctrl.$scope.circleMarkers, function (element, index, list) {\r\n            element.remove();\r\n        });\r\n\r\n        _.each(data, function (element, index, list) {\r\n            var r = parseInt(ctrl.panel.circleRadius.toString()) * 1.2;\r\n            var divIcon = L.divIcon({\r\n                html: '<canvas width=\"' + 2 * r + '\" height=\"' + 2 * r + '\" style=\"position:relative; top:-' + (r - 5) + 'px;left:-' + (r - 5) + 'px\"></canvas>',\r\n                iconSize: [12, 12]\r\n            });\r\n            var circle = L.marker([element.latitude, element.longitude], { icon: divIcon });\r\n            ctrl.$scope.circleMarkers.push(circle);\r\n            circle.addTo(ctrl.$scope.mapContainer);\r\n            ctrl.updatePhasorChart(circle._icon, element);\r\n        });\r\n\r\n    }\r\n\r\n    // #endregion\r\n\r\n    // #region Options Functions\r\n    changeMapBackground() {\r\n        var ctrl = this;\r\n\r\n        ctrl.$scope.tileLayer.remove();\r\n        ctrl.$scope.tileLayer = L.tileLayer(TileServers[this.panel.mapBackground].url, TileServers[this.panel.mapBackground].options);\r\n        ctrl.$scope.tileLayer.addTo(this.$scope.mapContainer);\r\n    }\r\n\r\n    updateZoom() {\r\n        var ctrl = this;\r\n\r\n        ctrl.$scope.mapContainer.options.minZoom = (ctrl.panel.lockMap == 'No' ? ctrl.panel.minZoom : ctrl.panel.zoomLevel);\r\n        ctrl.$scope.mapContainer.options.maxZoom = (ctrl.panel.lockMap == 'No' ? ctrl.panel.maxZoom : ctrl.panel.zoomLevel);\r\n\r\n        ctrl.$scope.mapContainer.setZoom(ctrl.panel.zoomLevel);\r\n    }\r\n\r\n    updateMapView() {\r\n        var ctrl = this;\r\n\r\n        ctrl.$scope.mapContainer.fitBounds([\r\n            [ctrl.panel.maxLatitude, ctrl.panel.maxLongitude],\r\n            [ctrl.panel.minLatitude, ctrl.panel.minLongitude]\r\n        ]);\r\n    }\r\n\r\n    lockMap() {\r\n        var ctrl = this;\r\n\r\n        ctrl.$scope.mapContainer.remove();\r\n        ctrl.$scope.mapContainer = null;\r\n        ctrl.createMap();\r\n    }\r\n\r\n    boundToMarkers() {\r\n        var ctrl = this;\r\n\r\n        var markerGroup = new L.featureGroup(ctrl.$scope.circleMarkers);\r\n        if (markerGroup.getBounds().isValid())\r\n            ctrl.$scope.mapContainer.fitBounds(markerGroup.getBounds());\r\n\r\n        var bounds = ctrl.$scope.mapContainer.getBounds();\r\n        ctrl.panel.maxLongitude = bounds._southWest.lng;\r\n        ctrl.panel.maxLatitude = bounds._northEast.lat;\r\n        ctrl.panel.minLatitude = bounds._southWest.lat;\r\n        ctrl.panel.minLongitude = bounds._northEast.lng;\r\n    }\r\n    //#endregion\r\n\r\n    // #region Angular Tag Functions\r\n    getRange(min, max, step) {\r\n        step = step || 1;\r\n        var input = [];\r\n        for (var i = min; i <= max; i += step) {\r\n            input.push(i);\r\n        }\r\n        return input;\r\n    }\r\n    // #endregion\r\n\r\n    fixAngle(angle) {\r\n        if (angle > -180 && angle <= 180) return angle;\r\n        else if (angle <= -180) return 360 + angle;\r\n        else if (angle > 180) return angle - 360;\r\n    }\r\n}\r\n\r\nPhasorMapCtrl.templateUrl = 'partials/module.html';\r\n"]}